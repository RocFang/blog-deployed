<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="strider (方鹏)">
<meta name="description" content="一个伪文青兼程序员的自嗨
    ">
<meta name="keywords" content="博客, 技术, 文学, 电影">
<meta name="referrer" content="always">
<title>利用 here document 携带 c 代码 - 纯真年代</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
<header>
  <div>
    <h1><a href="https://pureage.info/">纯真年代</a></h1><h2><a href="https://pureage.info/">阅读、体验、沉淀...</a></h2>
  </div>
  <nav><a href="/">博客</a><a href="/tools/">工具</a><a href="/about/">关于</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>利用 here document 携带 c 代码</h1>
  </div>
<div class="meta">
  <div>2013-10-08</div>
  <div>
    <span><a href="/tags/%E7%A8%8B%E5%BA%8F%E5%91%98">#程序员</a></span>
    <span><a href="/tags/shell">#shell</a></span>
    </div>
  </div>
<div class="content">
  <p>假设你想通过一段脚本调用 make 来编译代码，并且在脚本中将一些编译需要的系统信息传递给 makefile，可以通过 bash 的 here document 来实现。例如：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#000">tmp_src_filename</span>=fdfs_check_bits.c  
cat <span style="color:#5a2">&lt;&lt;EOF &gt; $tmp_src_filename  
</span><span style="color:#5a2">#include &lt;stdio.h&gt;  
</span><span style="color:#5a2">#include &lt;unistd.h&gt;  
</span><span style="color:#5a2">#include &lt;fcntl.h&gt;  
</span><span style="color:#5a2">int main()  
</span><span style="color:#5a2">{  
</span><span style="color:#5a2">        printf(&#34;%d\n&#34;, (int)sizeof(long));  
</span><span style="color:#5a2">        printf(&#34;%d\n&#34;, (int)sizeof(off_t));  
</span><span style="color:#5a2">        return 0;  
</span><span style="color:#5a2">}  
</span><span style="color:#5a2">EOF</span>  
  
gcc -D_FILE_OFFSET_BITS=<span style="color:#3af">64</span> -o a.out <span style="color:#000">$tmp_src_filename</span>  
<span style="color:#000">output</span>=<span style="color:#00f">$(</span>./a.out<span style="color:#00f">)</span>  
</code></pre></div><p>上面的代码摘自 FastDFS 的 make.sh。</p>
</div>

  </article>
</main>
<footer>
  <div>
    <div>2011-2020 strider. <a href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC-BY-4.0</a><p>Powered by <a href="https://gohugo.io/">Hugo</a> with <a href="https://github.com/yanlinlin82/simple-style">Simple-Style</a></div>
  </div>
</footer>
</body>
</html>
